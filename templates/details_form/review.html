{% extends "details_form/Created_base.html" %}

{% block title %}Review Application{% endblock %}

{% block content %}
{% include "details_form/tracker.html" %}

<div class="col-span-1 lg:col-span-9 space-y-8 bg-white">

    <!-- Profile Header -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8 relative overflow-hidden">
        <!-- Decorative background accent -->
        <div class="absolute top-0 left-0 w-full h-24 bg-gradient-to-r from-orange-100 to-amber-50 opacity-50"></div>

        <div class="relative flex flex-col md:flex-row items-center md:items-end gap-6 pt-4">
            <!-- Profile Photo -->
            <div class="flex-shrink-0">
                <div
                    class="w-32 h-32 md:w-40 md:h-40 rounded-full border-4 border-white shadow-md overflow-hidden bg-gray-100 flex items-center justify-center">
                    {% if admission.photo %}
                    <img src="{{ admission.photo.url }}" alt="Student Photo" class="w-full h-full object-cover">
                    {% else %}
                    <svg class="w-16 h-16 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    {% endif %}
                </div>
            </div>

            <!-- Basic Info -->
            <div class="flex-grow text-center md:text-left pb-2">
                <h1 class="text-3xl font-bold text-gray-900">{{ admission.student_name }}</h1>
                <p class="text-lg text-gray-500 font-medium">{{ admission.email }}</p>
                <div class="flex flex-wrap justify-center md:justify-start gap-3 mt-3">
                    {% if admission.application_number %}
                    <span
                        class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-50 text-blue-700">
                        App No: {{ admission.application_number }}
                    </span>
                    {% endif %}
                    <span
                        class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-orange-50 text-orange-700">
                        Reg: {{ admission.register_number }}
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Details Grid -->
    <div class="grid grid-cols-1 gap-8">

        <!-- 1. Personal Details -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">1. Personal Details</h2>
                <a href="{% url 'personal_details' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-y-6 gap-x-4">
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Student Name</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.student_name }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Mobile</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.student_mobile }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Email</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.email }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Date of Birth</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.dob }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Gender</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.gender }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Community</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.community }}</p>
                    </div>
                    <div class="md:col-span-3">
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Address</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.address }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Department Details -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">2. Department Details</h2>
                <a href="{% url 'department_details' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-y-6 gap-x-4">
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Level</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.level|upper }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Preferences</p>
                        <div class="mt-1">
                            {% if admission.department_preferences %}
                            {% for dept, pref in admission.department_preferences.items %}
                            {{ pref }}: {{ dept|upper }} <br> {% if not forloop.last %} {% endif %}
                            {% endfor %}
                            {% else %}
                            N/A
                            {% endif %}
                            {% if admission.pg_dept %}


                            {{ admission.pg_dept }}

                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Marks Obtained -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">3. Marks Obtained</h2>
                <a href="{% url 'marks_obtained' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="overflow-x-auto">
                    {% if admission.qualification == '12th' %}
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="border-b border-gray-100 text-xs text-gray-400 uppercase tracking-wider">
                                <th class="py-2 px-4 font-semibold">Subject</th>
                                <th class="py-2 px-4 font-semibold">Marks</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm text-gray-700">
                            <tr class="border-b border-gray-50">
                                <td class="py-3 px-4 font-medium">Maths</td>
                                <td class="py-3 px-4">{{ admission.maths_marks }}</td>
                            </tr>
                            <tr class="border-b border-gray-50">
                                <td class="py-3 px-4 font-medium">Physics</td>
                                <td class="py-3 px-4">{{ admission.physics_marks }}</td>
                            </tr>
                            <tr class="border-b border-gray-50">
                                <td class="py-3 px-4 font-medium">Chemistry</td>
                                <td class="py-3 px-4">{{ admission.chemistry_marks }}</td>
                            </tr>
                            <tr class="bg-orange-50/50">
                                <td class="py-3 px-4 font-bold text-gray-900">Total</td>
                                <td class="py-3 px-4 font-bold text-gray-900">{{ admission.twelfth_total }}</td>
                            </tr>
                        </tbody>
                    </table>
                    {% elif admission.qualification == 'Diploma' %}
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="border-b border-gray-100 text-xs text-gray-400 uppercase tracking-wider">
                                <th class="py-2 px-4 font-semibold">Subject</th>
                                <th class="py-2 px-4 font-semibold">Marks</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm text-gray-700">
                            <tr class="border-b border-gray-50">
                                <td class="py-3 px-4 font-medium">Diploma Percentage</td>
                                <td class="py-3 px-4">{{ admission.diploma_percentage }}</td>
                            </tr>
                            <tr class="border-b border-gray-50">
                                <td class="py-3 px-4 font-medium">Diploma Major</td>
                                <td class="py-3 px-4">{{ admission.diploma_major }}</td>
                            </tr>
                            <tr class="bg-orange-50/50">
                                <td class="py-3 px-4 font-bold text-gray-900">Total</td>
                                <td class="py-3 px-4 font-bold text-gray-900">{{ admission.diploma_total }}</td>
                            </tr>
                        </tbody>
                    </table>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- 4. Academic Info -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">4. Academic Information</h2>
                <a href="{% url 'academic_info' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-y-6 gap-x-4">
                    <div class="md:col-span-2">
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Last Institution</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.last_school }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Board</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.board }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Year of Passing</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.year_passing }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Medium</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.medium }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5, 6, 7. Other Details (Grouped) -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

            <!-- Vocational -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                    <h2 class="text-lg font-semibold text-gray-800">5. Vocational</h2>
                    <a href="{% url 'vocational_details' admission.pk %}"
                        class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
                </div>
                <div class="p-6">
                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Stream</p>
                    <p class="text-gray-900 font-medium mt-1">{{ admission.vocational_stream|default:"N/A" }}</p>
                </div>
            </div>

            <!-- 6. Facility Details -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden md:col-span-2">
                <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                    <h2 class="text-lg font-semibold text-gray-800">6. Facility Details</h2>
                    <a href="{% url 'facility_details' admission.pk %}"
                        class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Transport -->
                        <div class="space-y-4">
                            <h3 class="text-sm font-bold text-gray-700 uppercase tracking-wider">Transport</h3>
                            <div>
                                <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Bus Facility</p>
                                <p class="text-gray-900 font-medium mt-1">{{ admission.bus_needed|title }}</p>
                            </div>
                            {% if admission.bus_needed == "yes" %}
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Boarding
                                        Point</p>
                                    <p class="text-gray-900 font-medium mt-1">{{ admission.boarding_point }}</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Route</p>
                                    <p class="text-gray-900 font-medium mt-1">{{ admission.bus_route }}</p>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        <!-- Hostel -->
                        <div class="space-y-4">
                            <h3 class="text-sm font-bold text-gray-700 uppercase tracking-wider">Hostel</h3>
                            <div>
                                <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Hostel Needed
                                </p>
                                <p class="text-gray-900 font-medium mt-1">{{ admission.hostel_needed|title }}</p>
                            </div>
                            {% if admission.hostel_needed == "yes" %}
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Hostel Type
                                    </p>
                                    <p class="text-gray-900 font-medium mt-1">{{ admission.hostel_type }}</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Room Type
                                    </p>
                                    <p class="text-gray-900 font-medium mt-1">{{ admission.room_type }}</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Mess</p>
                                    <p class="text-gray-900 font-medium mt-1">{{ admission.mess_type }}</p>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fee Details -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                    <h2 class="text-lg font-semibold text-gray-800">7. Fee Details</h2>
                    <a href="{% url 'fee_details' admission.pk %}"
                        class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
                </div>
                <div class="p-6">
                    <table class="w-full text-sm">
                        <tbody class="divide-y divide-gray-50">
                            <tr>
                                <td class="py-2 text-gray-500">Admission Fee</td>
                                <td class="py-2 text-right font-medium text-gray-900">â‚¹{{ admission.admission_fee }}
                                </td>
                            </tr>
                            <tr>
                                <td class="py-2 text-gray-500">Tuition Fee</td>
                                <td class="py-2 text-right font-medium text-gray-900">â‚¹{{ admission.tuition_fee }}</td>
                            </tr>
                            <tr>
                                <td class="py-2 text-gray-500">College Fee</td>
                                <td class="py-2 text-right font-medium text-gray-900">â‚¹{{ admission.college_fee }}</td>
                            </tr>
                            <tr>
                                <td class="py-2 text-gray-500">PMSS Scholarship</td>
                                <td class="py-2 text-right font-medium text-gray-900">
                                    {% if admission.pmss %}<span class="text-green-600">Yes</span>{% else %}No{% endif%}
                                </td>
                            </tr>
                            <tr>
                                <td class="py-2 text-gray-500">First Graduate</td>
                                <td class="py-2 text-right font-medium text-gray-900">
                                    {% if admission.is_fg %}
                                    <span class="text-green-600">Yes</span> ({{ admission.fg_number }})
                                    {% else %}
                                    No
                                    {% endif %}
                                </td>
                            </tr>
                            <tr class="bg-gray-50/50">
                                <td class="py-3 font-semibold text-gray-700">Transaction ID</td>
                                <td class="py-3 text-right font-mono text-gray-600">{{ admission.transaction_id }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>


        <!-- 9. Reference Details -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">8. Reference Details</h2>
                <a href="{% url 'reference_details' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-y-6 gap-x-4">
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Name</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.reference_name }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Relationship</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.relationship }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Mobile</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.reference_mobile }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 10. Bank Details -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">9. Bank Details</h2>
                <a href="{% url 'bank_details' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-y-6 gap-x-4">
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Account Holder</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.account_holder_name|default:"N/A" }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Account Number</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.account_number|default:"N/A" }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Bank & Branch</p>
                        <p class="text-gray-900 font-medium mt-1">
                            {{ admission.bank_name|default:"N/A" }} - {{ admission.bank_branch|default:"N/A" }}
                        </p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">IFSC Code</p>
                        <p class="text-gray-900 font-medium mt-1 font-mono">{{ admission.ifsc_code|default:"N/A" }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Aadhaar Seeding</p>
                        <p class="text-gray-900 font-medium mt-1">{{ admission.seeding_status|default:"N/A" }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 11. Certificates Stats -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-semibold text-gray-800">10. Uploaded Documents</h2>
                <a href="{% url 'certificate_checklist' admission.pk %}"
                    class="text-sm font-medium text-orange-600 hover:text-orange-700 hover:underline">Edit</a>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-4">
                    {% comment %} Helper to check file existence {% endcomment %}

                    <!-- TC -->
                    <div
                        class="flex flex-col items-center p-3 rounded-lg border {% if admission.tc %}border-green-200 bg-green-50{% else %}border-gray-200 bg-gray-50{% endif %}">
                        <span class="text-2xl">ðŸ“„</span>
                        <span class="text-xs mt-2 font-medium text-center">Transfer Cert</span>
                        <span
                            class="text-[10px] mt-1 {% if admission.tc %}text-green-600{% else %}text-gray-400{% endif %}">
                            {% if admission.tc %}Uploaded{% else %}Pending{% endif %}
                        </span>
                    </div>

                    <!-- Community -->
                    <div
                        class="flex flex-col items-center p-3 rounded-lg border {% if admission.community_cert %}border-green-200 bg-green-50{% else %}border-gray-200 bg-gray-50{% endif %}">
                        <span class="text-2xl">ðŸ“œ</span>
                        <span class="text-xs mt-2 font-medium text-center">Community</span>
                        <span
                            class="text-[10px] mt-1 {% if admission.community_cert %}text-green-600{% else %}text-gray-400{% endif %}">
                            {% if admission.community_cert %}Uploaded{% else %}Pending{% endif %}
                        </span>
                    </div>

                    <!-- Aadhaar -->
                    <div
                        class="flex flex-col items-center p-3 rounded-lg border {% if admission.aadhaar %}border-green-200 bg-green-50{% else %}border-gray-200 bg-gray-50{% endif %}">
                        <span class="text-2xl">ðŸ†”</span>
                        <span class="text-xs mt-2 font-medium text-center">Aadhaar</span>
                        <span
                            class="text-[10px] mt-1 {% if admission.aadhaar %}text-green-600{% else %}text-gray-400{% endif %}">
                            {% if admission.aadhaar %}Uploaded{% else %}Pending{% endif %}
                        </span>
                    </div>

                    <!-- Mark Sheets -->
                    <div
                        class="flex flex-col items-center p-3 rounded-lg border {% if admission.tenth_marksheet %}border-green-200 bg-green-50{% else %}border-gray-200 bg-gray-50{% endif %}">
                        <span class="text-2xl">ðŸ“Š</span>
                        <span class="text-xs mt-2 font-medium text-center">Mark Sheets</span>
                        <span
                            class="text-[10px] mt-1 {% if admission.tenth_marksheet %}text-green-600{% else %}text-gray-400{% endif %}">
                            {% if admission.tenth_marksheet %}Uploaded{% else %}Pending{% endif %}
                        </span>
                    </div>

                    <!-- Photo -->
                    <div
                        class="flex flex-col items-center p-3 rounded-lg border {% if admission.photo %}border-green-200 bg-green-50{% else %}border-gray-200 bg-gray-50{% endif %}">
                        <span class="text-2xl">ðŸ“·</span>
                        <span class="text-xs mt-2 font-medium text-center">Photo</span>
                        <span
                            class="text-[10px] mt-1 {% if admission.photo %}text-green-600{% else %}text-gray-400{% endif %}">
                            {% if admission.photo %}Uploaded{% else %}Pending{% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Declaration & Submit -->
        <div class="bg-orange-50 rounded-2xl border border-orange-100 p-6 md:p-8 text-center space-y-4">
            <h3 class="text-lg font-semibold text-orange-800">Declaration</h3>
            <p class="text-sm text-gray-600 max-w-2xl mx-auto">
                I hereby declare that the particulars given above are true, correct, and complete to the best of my
                knowledge and belief.
            </p>
            <div class="pt-4">
                <a href="{% url 'success' admission.unique_id %}"
                    class="inline-flex items-center justify-center gap-2 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-8 py-3 rounded-xl font-medium shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5">
                    <span>Confirm & Final Submit</span>
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </a>
            </div>
        </div>

    </div>
</div>
{% endblock %}